"use strict";(self["webpackChunkvue"]=self["webpackChunkvue"]||[]).push([[210],{1210:function(e,t,s){s.r(t),s.d(t,{default:function(){return f}});var r=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-card",{staticClass:"card"},[s("div",{staticStyle:{"text-align":"center","margin-bottom":"30px"}},[s("b",[e._v("修改个人信息")])]),s("el-form",{attrs:{"label-width":"60px"}},[s("el-form-item",{attrs:{label:"头像"}},[s("el-upload",{staticClass:"avatar-uploader",attrs:{action:e.baseApi+"/avatar",headers:e.token,"show-file-list":!1,"on-success":e.handleAvatarSuccess}},[e.form.avatarUrl?s("img",{staticClass:"avatar",attrs:{src:e.baseApi+e.form.avatarUrl}}):s("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),s("el-form-item",{attrs:{label:"昵称"}},[s("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.nickname,callback:function(t){e.$set(e.form,"nickname",t)},expression:"form.nickname"}})],1),s("el-form-item",{attrs:{label:"电话"}},[s("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",t)},expression:"form.phone"}})],1),s("el-form-item",{attrs:{label:"邮箱"}},[s("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.email,callback:function(t){e.$set(e.form,"email",t)},expression:"form.email"}})],1),s("el-form-item",{attrs:{label:"地址"}},[s("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.address,callback:function(t){e.$set(e.form,"address",t)},expression:"form.address"}})],1),s("el-button",{staticStyle:{"font-size":"20px","margin-left":"190px","margin-top":"20px"},attrs:{type:"primary"},on:{click:e.save}},[s("i",{staticClass:"iconfont icon-r-yes",staticStyle:{"font-size":"22px"}}),e._v(" 确定")])],1),s("el-popover",{attrs:{placement:"right",width:"200",trigger:"click"}},[s("el-form",[s("el-form-item",{attrs:{label:"新密码"}},[s("el-input",{attrs:{type:"password",autocomplete:"off"},model:{value:e.resetPsw.newPassword,callback:function(t){e.$set(e.resetPsw,"newPassword",t)},expression:"resetPsw.newPassword"}})],1),s("el-form-item",{attrs:{label:"确认密码"}},[s("el-input",{attrs:{type:"password",autocomplete:"off"},model:{value:e.resetPsw.confirmPassword,callback:function(t){e.$set(e.resetPsw,"confirmPassword",t)},expression:"resetPsw.confirmPassword"}})],1),s("el-button",{staticStyle:{"font-size":"20px"},attrs:{type:"primary"},on:{click:e.toResetPassword}},[s("i",{staticClass:"iconfont icon-r-yes",staticStyle:{"font-size":"22px"}}),e._v(" 确定")])],1),s("el-button",{staticStyle:{"margin-left":"190px","margin-top":"20px","font-size":"20px"},attrs:{slot:"reference",type:"warning"},on:{click:function(t){e.resetPsw={newPassword:"",confirmPassword:""}}},slot:"reference"},[s("i",{staticClass:"iconfont icon-r-lock",staticStyle:{"font-size":"22px"}}),e._v(" 重置密码")])],1)],1)},a=[],o=s(7459),i=s.n(o),l={name:"Person",data(){return{form:{},baseApi:this.$store.state.baseApi,user:localStorage.getItem("user")?JSON.parse(localStorage.getItem("user")):{},resetPsw:{newPassword:"",confirmPassword:""}}},methods:{toResetPassword(){""!=this.resetPsw.newPassword.trim()?this.resetPsw.confirmPassword==this.resetPsw.newPassword?this.request.get("/user/resetPassword?id="+this.user.id+"&newPassword="+i()(this.resetPsw.newPassword)).then((e=>{"200"===e.code?(this.$message.success("修改成功"),this.resetPsw={newPassword:"",confirmPassword:""}):alert(e.msg)})):this.$message.error("两次密码不一致"):this.$message.error("新密码不能为空")},handleAvatarSuccess(e){this.imageUrl=e.data,this.form.avatarUrl=this.imageUrl},save(){this.request.post("/user",this.form).then((e=>{if("200"===e.code){this.$message.success("保存成功");for(let e in this.form)this.user[e]=this.form[e];localStorage.setItem("user",JSON.stringify(this.user)),this.$emit("refresh"),this.$router.go(0)}else this.$message.error(e.msg)}))}},created(){this.request.get("/userinfo/"+this.user.username).then((e=>{"200"===e.code?this.form=e.data:alert(e.msg)}))},mounted(){},computed:{token(){return{token:this.user.token}}}},n=l,c=s(1001),m=(0,c.Z)(n,r,a,!1,null,"42ee20b8",null),f=m.exports}}]);
//# sourceMappingURL=210.c21c48b3.js.map