"use strict";(self["webpackChunkvue"]=self["webpackChunkvue"]||[]).push([[20],{9020:function(t,e,s){s.r(e),s.d(e,{default:function(){return f}});var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticStyle:{"margin-top":"10px",width:"90%",margin:"10px auto"}},[s("div",{staticStyle:{"background-color":"white",padding:"10px","border-radius":"12px"}},[s("div",{staticStyle:{padding:"10px","margin-bottom":"20px","border-bottom":"1px solid #eee"}},[s("div",{staticStyle:{"font-size":"20px","border-bottom":"2px solid dodgerblue","padding-bottom":"10px","margin-bottom":"20px"}},[t._v(" 收货地址 "),s("el-button",{staticStyle:{height:"25px",padding:"5px"},on:{click:t.addAddress}},[t._v("+")])],1),t._l(t.addressData,(function(e,i){return[s("address-box",{key:i,class:i===t.checkedIndex?"active":" ",staticStyle:{"margin-right":"20px",cursor:"pointer"},attrs:{address:e},on:{edit:function(s){return t.editAddress(e)},delete:function(s){return t.deleteAddress(e)}},nativeOn:{click:function(e){return t.select(i)}}})]}))],2),s("el-dialog",{attrs:{title:"地址信息",visible:t.dialogFormVisible},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[s("el-form",{staticStyle:{padding:"0 60px"},attrs:{"label-width":"90px"}},[s("el-form-item",{attrs:{label:"联系人"}},[s("el-input",{attrs:{autocomplete:"off"},model:{value:t.address.linkUser,callback:function(e){t.$set(t.address,"linkUser",e)},expression:"address.linkUser"}})],1),s("el-form-item",{attrs:{label:"联系电话"}},[s("el-input",{attrs:{autocomplete:"off"},model:{value:t.address.linkPhone,callback:function(e){t.$set(t.address,"linkPhone",e)},expression:"address.linkPhone"}})],1),s("el-form-item",{attrs:{label:"地址"}},[s("el-input",{attrs:{autocomplete:"off"},model:{value:t.address.linkAddress,callback:function(e){t.$set(t.address,"linkAddress",e)},expression:"address.linkAddress"}})],1)],1),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{staticStyle:{"font-size":"20px"},on:{click:function(e){t.dialogFormVisible=!1}}},[s("i",{staticClass:"iconfont icon-r-left",staticStyle:{"font-size":"22px"}}),t._v(" 取消")]),s("el-button",{staticStyle:{"font-size":"20px"},attrs:{type:"primary"},on:{click:t.saveAddress}},[s("i",{staticClass:"iconfont icon-r-yes",staticStyle:{"font-size":"22px"}}),t._v(" 确定")])],1)],1),s("el-table",{staticStyle:{width:"100%"},attrs:{data:t.goods,stripe:""}},[s("el-table-column",{attrs:{label:"商品图片",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("el-image",{staticStyle:{width:"100px",height:"100px"},attrs:{src:t.baseApi+e.row.imgs,fit:"contain"}})]}}])}),s("el-table-column",{attrs:{prop:"name",label:"商品名称"}}),s("el-table-column",{attrs:{prop:"standard",label:"规格"}}),s("el-table-column",{attrs:{prop:"realPrice",label:"单价"}}),s("el-table-column",{attrs:{prop:"num",label:"数量"}}),s("el-table-column",{attrs:{label:"价格"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s((e.row.realPrice*e.row.num).toFixed(2))+" ")]}}])})],1),s("div",{staticStyle:{"margin-top":"10px"}},[s("div",{staticStyle:{"background-color":"white",padding:"10px"}},[s("div",{staticStyle:{color:"red","text-align":"right"}},[s("div",[s("span",[t._v("总价：")]),s("span",[t._v("￥ "+t._s(t.sumPrice))])]),s("div",{staticStyle:{"text-align":"right",color:"#999","font-size":"12px"}},[t._v(" 优惠： ￥"+t._s(t.sumDiscount)+" ")]),s("div",{staticStyle:{padding:"10px 0"}},[s("el-button",{staticStyle:{"background-color":"red",color:"white",width:"100px"},on:{click:t.submitOrder}},[t._v("提交订单")])],1)])])])],1)])},r=[],o=s(5972),a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"box",staticStyle:{position:"relative","border-radius":"10px"}},[s("div",[s("span",[t._v(" "+t._s(t.address.linkUser))])]),s("hr",{staticStyle:{margin:"10px 0","font-size":"1px"}}),s("span",[t._v(" "+t._s(t.address.linkPhone))]),s("span",[t._v(" "+t._s(t.address.linkAddress))]),s("div",{staticStyle:{"margin-top":"5px"}},[s("a",{staticStyle:{color:"#710a0a",cursor:"pointer",position:"absolute",bottom:"10px"},on:{click:function(e){return t.$emit("edit")}}},[t._v("修改")]),s("a",{staticStyle:{color:"#710a0a",cursor:"pointer",float:"right",position:"absolute",bottom:"10px",right:"10px"},on:{click:function(e){return t.$emit("delete")}}},[t._v("删除")])])])},d=[],l={name:"AddressBox",props:{address:Object}},n=l,c=s(1001),u=(0,c.Z)(n,a,d,!1,null,"530e08b2",null),p=u.exports,h={name:"cart",data(){return{baseApi:this.$store.state.baseApi,userId:0,addressData:[],address:{},checkedIndex:0,dialogFormVisible:!1,good:{},realPrice:-1,goods:[],cartId:""}},components:{"address-box":p},created(){this.loadAddress(),this.good=JSON.parse(this.$route.query.good),this.good.realPrice=this.$route.query.realPrice,this.good.num=this.$route.query.num,this.good.standard=this.$route.query.standard,this.cartId=this.$route.query.cartId,this.goods.push(this.good)},computed:{sumPrice:function(){let t=0;return this.goods.forEach((function(e){t+=e.realPrice*e.num})),t.toFixed(2)},sumDiscount:function(){let t=0;return this.goods.forEach((function(e){t+=(e.realPrice/e.discount-e.realPrice)*e.num})),t.toFixed(2)}},methods:{select(t){console.log(t),this.checkedIndex=t},addAddress(){this.address={},this.dialogFormVisible=!0},editAddress(t){this.address=JSON.parse(JSON.stringify(t)),this.dialogFormVisible=!0},deleteAddress(t){this.$confirm("您确认删除该地址吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{o.Z["delete"]("api/address/"+t.id).then((t=>{"200"===t.code&&(this.$message.success("删除地址成功"),this.loadAddress())}))}))},saveAddress(){this.address.userId=this.userId,o.Z.post("/api/address",this.address).then((t=>{"200"===t.code?(this.$message.success("保存成功"),this.loadAddress(),this.dialogFormVisible=!1):this.$message.error(t.msg)}))},loadAddress(){o.Z.get("/userid").then((t=>{this.userId=t,o.Z.get("/api/address/"+t).then((t=>{"200"===t.code&&(this.addressData=t.data,console.log("address"+this.addressData))}))}))},submitOrder(){let t=this.addressData[this.checkedIndex];console.log(t),t?(console.log(JSON.stringify(this.good)),o.Z.post("/api/order",{totalPrice:this.sumPrice,linkUser:t.linkUser,linkPhone:t.linkPhone,linkAddress:t.linkAddress,state:"待付款",goods:JSON.stringify(this.goods),cartId:this.cartId}).then((t=>{if("200"===t.code){let e=t.data;this.$router.replace({path:"pay",query:{money:this.sumPrice,orderNo:e}})}else this.$message({type:"error",message:t.msg})}))):this.$message({type:"warning",message:"请选择收货地址！"})}}},m=h,g=(0,c.Z)(m,i,r,!1,null,"c5e39606",null),f=g.exports}}]);
//# sourceMappingURL=20.2e257ba4.js.map