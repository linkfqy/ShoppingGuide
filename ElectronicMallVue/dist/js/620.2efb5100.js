"use strict";(self["webpackChunkvue"]=self["webpackChunkvue"]||[]).push([[620],{1620:function(t,e,s){s.r(e),s.d(e,{default:function(){return c}});var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"main-box"},[s("div",[s("div",{staticClass:"image-container"},[s("img",{attrs:{src:t.baseApi+t.good.imgs,alt:"Your Image"}})]),s("div",{staticClass:"detail-box"},[s("div",[s("span",{staticStyle:{"font-size":"22px"}},[s("strong",[t._v(t._s(t.good.name))])]),s("br")]),s("div",{staticStyle:{"margin-top":"20px"}},[s("span",{staticStyle:{"font-size":"17px"}},[t._v(t._s(t.good.description))])]),t.good.discount<1?s("div",{staticClass:"price-box"},[s("dl",[s("div",[s("dt",[t._v("原价")]),s("dd",{staticStyle:{"text-decoration":"line-through"}},[s("b",[t._v(t._s(t.price))]),t._v("元 ")])]),s("div",[s("dt",[t._v("折扣")]),s("dd",[t._v(t._s(t.discount))])]),s("div",[s("dt",[t._v("现价")]),s("dd",{staticStyle:{color:"red","font-size":"25px"}},[s("b",[t._v(t._s(t.realPrice))]),t._v("元 ")])])])]):t._e(),1===t.good.discount?s("div",{staticClass:"price-box"},[s("dl",[s("div",[s("dt",[t._v("价格")]),s("dd",{staticStyle:{color:"red","font-size":"25px"}},[t._v(" ￥ "),s("b",[t._v(t._s(t.price))])])])])]):t._e(),s("div",{staticStyle:{"margin-top":"20px"}},[s("span",[t._v("月销量：")]),s("span",[t._v(t._s(t.good.sales))]),s("br"),t.showStore?s("span",{staticStyle:{height:"40px"}},[t._v("库存："+t._s(t.store))]):t._e()]),0!==t.standards.length?s("div",{staticStyle:{"margin-top":"15px",height:"50px"}},t._l(t.standards,(function(e,i){return s("el-radio-group",{key:i,on:{change:function(s){return t.change(e)}},model:{value:t.checkedStandard,callback:function(e){t.checkedStandard=e},expression:"checkedStandard"}},[s("el-radio-button",{staticClass:"standard",attrs:{label:e.value}})],1)})),1):t._e(),s("div",{staticStyle:{"margin-top":"20px"}},[s("el-input-number",{attrs:{"controls-position":"right",min:1,max:t.store},model:{value:t.count,callback:function(e){t.count=e},expression:"count"}})],1),s("div",{staticStyle:{"margin-top":"30px"}},[s("el-button",{staticStyle:{"font-size":"22px"},attrs:{type:"success"},on:{click:t.goToOrder}},[s("i",{staticClass:"iconfont icon-r-yes",staticStyle:{"font-size":"26px"}}),t._v(" 购买")]),s("el-button",{staticStyle:{"font-size":"22px"},attrs:{type:"primary"},on:{click:t.addToCart}},[s("i",{staticClass:"iconfont icon-r-add",staticStyle:{"font-size":"26px"}}),t._v(" 加入购物车")])],1)])])])},o=[],r=(s(5972),{name:"GoodView",data(){return{baseApi:this.$store.state.baseApi,good:{},goodId:Number,price:-1,isDiscount:!1,discount:"",standards:[],checkedStandard:"",store:0,showStore:!1,count:1}},methods:{getPriceRange(t){let e=t.map((t=>t.price));for(let s=0;s<e.length;s++){let t=s;for(let i=s+1;i<e.length;i++)e[i]<e[t]&&(t=i);[e[s],e[t]]=[e[t],e[s]]}return e[0]===e[e.length-1]?e[0]:e[0]+"元 ~ "+e[e.length-1]},change(t){this.showStore=!0,this.price=t.price,this.store=t.store},goToOrder(){if(0!==this.standards.length&&""===this.checkedStandard)return this.$message.warning("请选择规格"),!1;console.log(this.good),console.log(this.checkedStandard),this.$router.push({name:"preOrder",query:{good:JSON.stringify(this.good),realPrice:this.realPrice,num:this.count,standard:this.checkedStandard}})},addToCart(){if(console.log(localStorage.getItem("user")),localStorage.getItem("user")||this.$router.push("/login"),!this.checkedStandard)return this.$message.error("请选择规格"),!1;this.request.get("/userid").then((t=>{let e=t,s={userId:e,goodId:this.goodId,standard:this.checkedStandard,count:this.count};this.request.post("/api/cart",s).then((t=>{"200"===t.code&&this.$message.success("成功添加购物车")}))}))}},created(){this.goodId=this.$route.params.goodId,this.request.get("/api/good/"+this.goodId).then((t=>{if("200"===t.code){this.good=t.data;let e=this.good.discount;e<1&&(this.isDiscount=!0,this.discount=10*e+"折")}else this.$router.go(0)})).catch((t=>{this.$message.error(t.response.data),console.log(t)})),this.request.get("/api/good/standard/"+this.goodId).then((t=>{if("200"===t.code){let e=JSON.parse(t.data);this.standards=e,this.price=this.getPriceRange(e)}else this.price=this.good.price,this.store=this.good.store,this.showStore=!0})).catch((t=>{this.$message.error(t.response.data),console.log(t)}))},mounted(){},computed:{realPrice:function(){if(this.good.discount<1){if(isNaN(this.price)){let t=this.price.substring(0,this.price.indexOf("元"))*this.good.discount,e=this.price.substring(this.price.lastIndexOf(" "))*this.good.discount;return t.toFixed(2)+"元 ~ "+e.toFixed(2)}return(this.price*this.good.discount).toFixed(2)}return this.price}}}),a=r,d=s(1001),n=(0,d.Z)(a,i,o,!1,null,"3ac68fa0",null),c=n.exports}}]);
//# sourceMappingURL=620.2efb5100.js.map