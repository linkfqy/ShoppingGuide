"use strict";(self["webpackChunkvue"]=self["webpackChunkvue"]||[]).push([[603],{603:function(t,e,s){s.r(e),s.d(e,{default:function(){return u}});var o=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticStyle:{width:"1000px",margin:"50px auto"}},[s("el-form",{attrs:{model:t.good}},[s("el-form-item",{attrs:{label:"商品名称","label-width":"150px"}},[s("el-input",{staticStyle:{width:"80%"},attrs:{autocomplete:"off"},model:{value:t.good.name,callback:function(e){t.$set(t.good,"name",e)},expression:"good.name"}})],1),s("el-form-item",{attrs:{label:"商品描述","label-width":"150px"}},[s("el-input",{staticStyle:{width:"80%"},attrs:{autocomplete:"off"},model:{value:t.good.description,callback:function(e){t.$set(t.good,"description",e)},expression:"good.description"}})],1),s("el-form-item",{attrs:{label:"规格","label-width":"150px"}},[t._l(t.standards,(function(e,o){return s("el-tag",{key:o,staticStyle:{"margin-right":"10px"},attrs:{closable:"","disable-transitions":!0},on:{close:function(s){return t.handleClose(e)},click:function(e){return t.editStandard(o)}}},[t._v(t._s(e.value))])})),s("el-button",{attrs:{icon:"el-icon-plus",circle:""},on:{click:t.addStandard}})],2),s("el-form-item",{attrs:{label:"折扣","label-width":"150px"}},[s("el-input",{staticStyle:{width:"80%"},attrs:{autocomplete:"off"},model:{value:t.good.discount,callback:function(e){t.$set(t.good,"discount",e)},expression:"good.discount"}})],1),s("el-form-item",{attrs:{label:"分类","label-width":"150px"}},[s("el-select",{attrs:{placeholder:"请选择"},model:{value:t.good.categoryId,callback:function(e){t.$set(t.good,"categoryId",e)},expression:"good.categoryId"}},t._l(t.categoryItems,(function(t){return s("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1)],1),s("el-form-item",{attrs:{label:"商品图片","label-width":"150px"}},[s("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{action:t.baseApi+"/file/upload","file-list":t.fileList,"on-change":t.handleChange,limit:1,"on-remove":t.handleRemove,"on-success":t.handleImgSuccess,"auto-upload":!1}},[s("el-button",{attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[t._v("选取文件")]),s("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v(" 只能上传一个jpg/png文件，且不超过500kb ")])],1)],1),s("el-form-item",{attrs:{"label-width":"150px"}},[s("el-button",{staticStyle:{"font-size":"20px"},attrs:{type:"success"},on:{click:t.submit}},[s("i",{staticClass:"iconfont icon-r-yes",staticStyle:{"font-size":"22px"}}),t._v("提交")])],1)],1),s("el-dialog",{attrs:{title:"规格信息",visible:t.dialogFormVisible,width:"30%","close-on-click-modal":!1},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[s("el-form",{attrs:{model:t.standard}},[s("el-form-item",{attrs:{label:"规格名称","label-width":"150px"}},[s("el-input",{staticStyle:{width:"80%"},attrs:{autocomplete:"off"},model:{value:t.standard.value,callback:function(e){t.$set(t.standard,"value",e)},expression:"standard.value"}})],1),s("el-form-item",{attrs:{label:"价格","label-width":"150px"}},[s("el-input",{staticStyle:{width:"80%"},attrs:{autocomplete:"off"},model:{value:t.standard.price,callback:function(e){t.$set(t.standard,"price",e)},expression:"standard.price"}})],1),s("el-form-item",{attrs:{label:"库存","label-width":"150px"}},[s("el-input",{staticStyle:{width:"80%"},attrs:{autocomplete:"off"},model:{value:t.standard.store,callback:function(e){t.$set(t.standard,"store",e)},expression:"standard.store"}})],1)],1),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{staticStyle:{"font-size":"20px"},on:{click:function(e){t.dialogFormVisible=!1}}},[s("i",{staticClass:"iconfont icon-r-left",staticStyle:{"font-size":"22px"}}),t._v(" 取消")]),s("el-button",{staticStyle:{"font-size":"20px"},attrs:{type:"primary"},on:{click:t.saveStandard}},[s("i",{staticClass:"iconfont icon-r-yes",staticStyle:{"font-size":"22px"}}),t._v(" 确定")])],1)],1)],1)},a=[],i=(s(561),s(7042),s(8309),s(3210),s(2526),s(1817),s(5972)),l="/api/good",d={name:"GoodInfo",data:function(){return{baseApi:this.$store.state.baseApi,good:{discount:"1"},standards:[],index:0,standard:{},fileList:[],dialogFormVisible:!1,categoryItems:[],checkedCategory:{}}},created:function(){var t=this;this.request.get("/api/category").then((function(e){"200"===e.code&&(t.categoryItems=e.data),t.$route.query.good&&(t.good=JSON.parse(t.$route.query.good),t.fileList=[{name:"原始图片",url:t.good.imgs}],t.checkedCategory=t.categoryItems[t.good.categoryId],t.request.get(l+"/standard/"+t.good.id).then((function(e){if("200"===e.code){var s=JSON.parse(e.data);t.standards=s}})))}))},methods:{editStandard:function(t){this.standard=this.standards[t],this.index=t,this.dialogFormVisible=!0},addStandard:function(){this.standard={},this.index=this.standards.length,this.dialogFormVisible=!0},saveStandard:function(){void 0!=this.standard.value&&""!=this.standard.value?void 0!=this.standard.price&&""!=this.standard.price?void 0!=this.standard.store&&""!=this.standard.store?(this.standards[this.index]=this.standard,this.dialogFormVisible=!1):this.$message({type:"error",message:"请输入库存",showClose:!0}):this.$message({type:"error",message:"请输入价格",showClose:!0}):this.$message({type:"error",message:"请输入规格名称",showClose:!0})},handleClose:function(t){this.standards.splice(this.standards.indexOf(t),1)},handleImgSuccess:function(t){this.good.imgs=t.data,this.save()},handleChange:function(t,e){this.fileList=e.slice(-3)},handleRemove:function(){this.fileList.pop()},submit:function(){return void 0==this.good.name||""==this.good.name.trim()?(this.$message({type:"error",message:"请输入商品名称",showClose:!0}),!1):void 0==this.good.description||""==this.good.description.trim()?(this.$message({type:"error",message:"请输入商品描述",showClose:!0}),!1):0===this.standards.length?(this.$message({type:"error",message:"请至少添加一个规格",showClose:!0}),!1):void 0==this.good.discount||""===this.good.discount?(this.$message({type:"error",message:"请输入商品折扣",showClose:!0}),!1):void 0==this.good.categoryId?(this.$message({type:"error",message:"请选择商品分类",showClose:!0}),!1):0===this.fileList.length?(this.$message({type:"error",message:"请上传图片",showClose:!0}),!1):void("ready"===this.fileList[0].status?this.$refs.upload.submit():"success"===this.fileList[0].status&&this.save())},save:function(){var t=this;i.Z.post(l,this.good).then((function(e){"200"===e.code?(t.good.id=e.data,t.request.post(l+"/standard?goodId="+t.good.id,t.standards).then((function(e){"200"===e.code?(t.$message({type:"success",message:"操作成功",showClose:!0}),t.$router.go(-1)):t.$message({type:"error",message:"操作失败",showClose:!0})}))):t.$message({type:"error",message:e.msg})}))}}},r=d,n=s(1001),c=(0,n.Z)(r,o,a,!1,null,"76c0d79e",null),u=c.exports}}]);
//# sourceMappingURL=603-legacy.f43fd8b4.js.map